Edited from ffbranch

Edited from master
